/*
Burner
Copyright (c) 2013 Vince Allen | vince@vinceallen.com | http://www.vinceallen.com | florajs.com/license
*/
/* Version: 2.0.1 */
/* Build time: May 28, 2013 01:21:12 */var Burner={},exports=Burner;
(function(d){function f(a,b){this.x=a||0;this.y=b||0}function l(){var a,b;this.name="StatsDisplay";this._active=!0;this._fps=0;this._timeLastSecond=this._timeLastFrame=this._time=Date.now?Date.now():0;this._frameCount=0;this.el=document.createElement("div");this.el.id="statsDisplay";this.el.className="statsDisplay";this.el.style.backgroundColor="black";this.el.style.color="white";this.el.style.fontFamily="Helvetica";this.el.style.padding="0.5em";this.el.style.opacity="0.5";this._fpsValue=this._totalElementsValue=
null;a=document.createElement("span");a.className="statsDisplayLabel";a.style.marginLeft="0.5em";b=document.createTextNode("total elements: ");a.appendChild(b);this.el.appendChild(a);this._totalElementsValue=document.createTextNode("0");this.el.appendChild(this._totalElementsValue);a=document.createElement("span");a.className="statsDisplayLabel";a.style.marginLeft="0.5em";b=document.createTextNode("fps: ");a.appendChild(b);this.el.appendChild(a);this._fpsValue=document.createTextNode("0");this.el.appendChild(this._fpsValue);
document.body.appendChild(this.el);this._update(this)}function k(){}function i(a){if(!a||!a.world||"object"!==typeof a.world)throw Error('Item: A valid DOM object is required for the new Item "world" property.');this.world=a.world;this.name=a.name||"Item";this.id=this.name+d.System.getNewId();this._force=new d.Vector;this._camera=new d.Vector;this.el=document.createElement("div");this.el.id=this.id;this.el.className="item "+this.name.toLowerCase();this.el.style.visibility="hidden";this.world.el.appendChild(this.el)}
function m(a,b){if(!a||"object"!==typeof a)throw Error('World: A valid DOM object is required for the new World "el" property.');var e=b||{};this.el=a;this.name="World";this.id=this.name+d.System.getNewId();this.width=e.width||0;this.height=e.height||0;this.angle=0;this.color=e.color||"transparent";this.colorMode=e.colorMode||"rgb";this.visibility=e.visibility||"visible";this.opacity=e.opacity||1;this.borderWidth=e.borderWidth||0;this.borderStyle=e.borderStyle||"none";this.borderColor=e.borderColor||
"transparent";this.boxShadowOffset=e.boxShadowOffset||new d.Vector;this.boxShadowBlur=e.boxShadowBlur||0;this.boxShadowSpread=e.boxShadowSpread||0;this.boxShadowColor=e.boxShadowColor||"transparent";this.gravity=e.gravity||new d.Vector(0,1);this.c=e.c||0.1;this.boundToWindow=!1===e.boundToWindow?!1:!0;this.pauseDraw=this.pauseStep=!1;this._setBounds();this._pool=[];this.world={};this.draw()}function o(a){a=a||{};a.name="Box";d.Item.call(this,a)}function p(a){a=a||{};a.name="Ball";d.Item.call(this,
a)}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};f.VectorSub=function(a,b){return new f(a.x-b.x,a.y-b.y)};f.VectorAdd=function(a,b){return new f(a.x+b.x,a.y+b.y)};f.VectorMult=function(a,b){return new f(a.x*b,a.y*b)};f.VectorDiv=function(a,b){return new f(a.x/b,a.y/b)};f.VectorDistance=function(a,b){return Math.sqrt(Math.pow(b.x-
a.x,2)+Math.pow(b.y-a.y,2))};f.VectorMidPoint=function(a,b){return f.VectorAdd(a,b).div(2)};f.VectorAngleBetween=function(a,b){var e=a.dot(b);return Math.acos(e/(a.mag()*b.mag()))};f.prototype.name="Vector";f.prototype.clone=function(){function a(){}a.prototype=this;return new a};f.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};f.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};f.prototype.mult=function(a){this.x*=a;this.y*=a;return this};f.prototype.div=function(a){this.x/=
a;this.y/=a;return this};f.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};f.prototype.limit=function(a,b){var e=a||null,c=b||null;e&&this.mag()>e&&(this.normalize(),this.mult(e));c&&this.mag()<c&&(this.normalize(),this.mult(c));return this};f.prototype.normalize=function(){var a=this.mag();if(0!==a)return this.div(a)};f.prototype.distance=function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,2))};f.prototype.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),
e=this.x,c=this.y;this.x=e*b-c*a;this.y=e*a+c*b;return this};f.prototype.midpoint=function(a){return f.VectorAdd(this,a).div(2)};f.prototype.dot=function(a){return this.z&&a.z?this.x*a.x+this.y*a.y+this.z*a.z:this.x*a.x+this.y*a.y};d.Vector=f;l.prototype.getFPS=function(){return this._fps};l.prototype._update=function(a){var b=d.System.count();a._time=Date.now?Date.now():0;a._frameCount++;a._time>a._timeLastSecond+1E3&&(a._fps=a._frameCount,a._timeLastSecond=a._time,a._frameCount=0,a._fpsValue.nodeValue=
a._fps,a._totalElementsValue.nodeValue=b);var e=this;this._active&&window.requestAnimFrame(function(){e._update(e)})};l.prototype.destroy=function(){this._active=!1;document.getElementById(this.el.id)&&document.body.removeChild(this.el)};d.StatsDisplay=l;k.detect=function(a){return!this[a]?!1:this[a].call(this)};k.csstransforms=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translateX(1px) translateY(1px);-moz-transform: translateX(1px) translateY(1px);-o-transform: translateX(1px) translateY(1px);-ms-transform: translateX(1px) translateY(1px)";
for(var a=[b.style.transform,b.style.webkitTransform,b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,e=0;e<a.length;e+=1)if(a[e]){b=!0;break}return b};k.csstransforms3d=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translate3d(1px, 1px, 0);-moz-transform: translate3d(1px, 1px, 0);-o-transform: translate3d(1px, 1px, 0);-ms-transform: translate3d(1px, 1px, 0)";for(var a=[b.style.transform,b.style.webkitTransform,
b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,e=0;e<a.length;e+=1)if(a[e]){b=!0;break}return b};k.touch=function(){var a=document.createElement("div");a.setAttribute("ongesturestart","return;");return"function"===typeof a.ongesturestart?!0:!1};d.FeatureDetector=k;i.prototype.reset=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.width=a.width||10;this.height=a.height||10;this.color=a.color||[0,0,0];this.colorMode=a.colorMode||"rgb";this.visibility=a.visibility||
"visible";this.opacity=a.opacity||1;this.zIndex=a.zIndex||1;this.borderWidth=a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||"transparent";this.borderRadius=a.borderRadius||0;this.boxShadowOffset=a.boxShadowOffset||new d.Vector;this.boxShadowBlur=a.boxShadowBlur||0;this.boxShadowSpread=a.boxShadowSpread||0;this.boxShadowColor=a.boxShadowColor||"transparent";this.bounciness=a.bounciness||0.8;this.mass=a.mass||10;this.acceleration="function"===typeof a.acceleration?
a.acceleration.call(this):a.acceleration||new d.Vector;this.velocity="function"===typeof a.velocity?a.velocity.call(this):a.velocity||new d.Vector;this.location="function"===typeof a.location?a.location.call(this):a.location||new d.Vector(this.world.width/2,this.world.height/2);this.maxSpeed=0===a.maxSpeed?0:a.maxSpeed||10;this.minSpeed=a.minSpeed||0;this.angle=a.angle||0;this.lifespan=0===a.lifespan?0:a.lifespan||-1;this.life=a.life||0;this.isStatic=!!a.isStatic;this.controlCamera=!!a.controlCamera;
this.worldBounds=a.worldBounds||[!0,!0,!0,!0];this.checkWorldEdges=!1===a.checkWorldEdges?!1:!0;this.wrapWorldEdges=!!a.wrapWorldEdges;this.avoidWorldEdges=!!a.avoidWorldEdges;this.avoidWorldEdgesStrength=a.avoidWorldEdgesStrength||50};i.prototype.step=function(){this.isStatic||(this.applyForce(this.world.gravity),this.velocity.add(this.acceleration),this.velocity.limit(this.maxSpeed,this.minSpeed),this.location.add(this.velocity),this.controlCamera&&this._checkCameraEdges(),this.checkWorldEdges&&
this._checkWorldEdges(),this.acceleration.mult(0),this.life<this.lifespan?this.life++:-1!==this.lifespan&&d.System.destroyItem(this))};i.prototype.applyForce=function(a){if(a)return this._force.x=a.x,this._force.y=a.y,this._force.div(this.mass),this.acceleration.add(this._force),this.acceleration};i.prototype._checkWorldEdges=function(){var a=this.world.bounds[1],b=this.world.bounds[2],e=this.worldBounds,c=this.location,g=this.velocity,d=this.width,f=this.height,n=this.bounciness;this.wrapWorldEdges?
(e=c.x,g=c.y,c.x>a?(c.x=0,this.controlCamera&&(this.world.location.x=this.world.location.x+e-c.x)):0>c.x&&(c.x=a,this.controlCamera&&(this.world.location.x=this.world.location.x+e-c.x)),c.y>b)?(c.y=0,this.controlCamera&&(this.world.location.y=this.world.location.y+g-c.y)):c.y<-f/2&&(c.y=b,this.controlCamera&&(this.world.location.y=this.world.location.y+g-c.y)):(c.x+d/2>a&&e[1]?(c.x=a-d/2,g.x*=-1*n):c.x<d/2&&e[3]&&(c.x=d/2,g.x*=-1*n),c.y+f/2>b&&e[2])?(c.y=b-f/2,g.y*=-1*n):c.y<f/2&&e[0]&&(c.y=f/2,g.y*=
-1*n)};i.prototype._checkCameraEdges=function(){this._camera.x=this.velocity.x;this._camera.y=this.velocity.y;this.world.location.add(this._camera.mult(-1))};i.prototype.draw=function(){d.System._draw(this)};d.Item=i;var c={name:"System",_stylePosition:"",clock:0,supportedFeatures:{csstransforms:!0,csstransforms3d:!0},_records:{lookup:{},list:[]},_caches:{},_idCount:0};c.mouse={location:new d.Vector,lastLocation:new d.Vector,velocity:new d.Vector};c._resizeTime=0;c.init=function(a,b,e,j,g){a=a||function(){};
e=e||document.body;b=b||{};j=j||null;g=!g?!1:!0;if(j)if("object"===typeof j&&"undefined"!==typeof j.csstransforms&&"undefined"!==typeof j.csstransforms3d)this.supportedFeatures=j;else throw Error("System: supportedFeatures should be passed as an object.");else this.supportedFeatures=c._getSupportedFeatures();this._stylePosition=this.supportedFeatures.csstransforms3d?"-webkit-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -moz-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -o-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -ms-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>);":
this.supportedFeatures.csstransforms?"-webkit-transform: translate(<x>px, <y>px) rotate(<angle>deg) scale(<scale>, <scale>); -moz-transform: translate(<x>px, <y>px) rotate(<angle>deg) scale(<scale>, <scale>); -o-transform: translate(<x>px, <y>px) rotate(<angle>deg) scale(<scale>, <scale>); -ms-transform: translate(<x>px, <y>px) rotate(<angle>deg) scale(<scale>, <scale>);":"position: absolute; left: <x>px; top: <y>px;";document.body.onorientationchange=c.updateOrientation;c._records.list.push(new d.World(e,
b));c.updateCache(c._records.list[0]);this._addEvent(document,"mousemove",function(a){c._recordMouseLoc.call(c,a)});this._addEvent(window,"touchstart",function(a){c._recordMouseLoc.call(c,a)});this._addEvent(window,"touchmove",function(a){c._recordMouseLoc.call(c,a)});this._addEvent(window,"touchend",function(a){c._recordMouseLoc.call(c,a)});this._addEvent(window,"resize",function(a){c._resize.call(c,a)});this._addEvent(window,"devicemotion",function(a){var b=c._records.list[0],e=a.accelerationIncludingGravity.x,
a=a.accelerationIncludingGravity.y;0===window.orientation?(b.gravity.x=e,b.gravity.y=-1*a):-90===window.orientation?(b.gravity.x=a,b.gravity.y=e):(b.gravity.x=-1*a,b.gravity.y=-1*e)});this._addEvent(window,"keyup",function(a){c._keyup.call(c,a)});this._setup=a;this._setup.call(this);g||this._update()};c.add=function(a,b){var e,d,g=this._records.list,f=this._records.lookup,h=b||{};h.world=g[0];if(this.getAllItemsByName(a,h.world._pool).length){e=0;for(d=h.world._pool.length;e<d;e++)if(h.world._pool[e].name===
a){g[g.length]=h.world._pool.splice(e,1)[0];g[g.length-1].options=h;c._updateCacheLookup(g[g.length-1],!0);break}}else g[g.length]=Burner[a]?new Burner[a](h):new Burner.Classes[a](h);e=g.length-1;f[g[e].id]=g[e].el.parentNode;g[e].reset(h);g[e].init(h);return g[e]};c.start=function(){this._update()};c.updateCache=function(a){var b=c._caches[a.name]||(c._caches[a.name]={lookup:{},list:[]});b.list[b.list.length]=a;b.lookup[a.id]=!0;return b};c._updateCacheLookup=function(a,b){var e=c._caches[a.name];
e&&(e.lookup[a.id]=b)};c.count=function(){return this._records.list.length};c.firstWorld=function(){return this._caches.World?this._caches.World.list[0]:null};c.lastWorld=function(){return this._caches.World?this._caches.World.list[this._caches.World.list.length-1]:null};c.firstItem=function(){return this._records.list[0]};c.lastItem=function(){return this._records.list[this._records.list.length-1]};c._update=function(){var a,b=c._records.list,e;c._resizeTime&&100<(new Date).getTime()-c._resizeTime&&
(c._resizeTime=0,c.firstWorld().pauseStep=!1);for(a=b.length-1;0<=a;a-=1)e=b[a],e.step&&!e.world.pauseStep&&e.step();for(a=b.length-1;0<=a;a-=1)e=b[a],e.draw&&!e.world.drawStep&&e.draw();c.clock++;window.requestAnimFrame(c._update)};c._stepForward=function(){var a,b=c._records.list;this._records.list[0].pauseStep=!0;for(a=b.length-1;0<=a;a-=1)b[a].step&&b[a].step();for(a=b.length-1;0<=a;a-=1)b[a].draw&&b[a].draw();c.clock++};c._resetSystem=function(a){var b=this._records.list[0];b.pauseStep=!1;for(b.pauseDraw=
!1;b.el.firstChild;)b.el.removeChild(b.el.firstChild);c._destroyAllItems();c._idCount=0;c.mouse={location:new d.Vector,lastLocation:new d.Vector,velocity:new d.Vector};c._resizeTime=0;a||c._setup.call(c)};c._destroySystem=function(){this._resetSystem(!0)};c._destroyAllItems=function(){var a,b=this._records.list;for(a=b.length-1;0<=a;a--)"World"!==b[a].name&&b.splice(a,1)};c.destroyItem=function(a){var b,e,d=this._records.list;b=0;for(e=d.length;b<e;b++)if(d[b].id===a.id){d[b].el.style.visibility=
"hidden";d[b].el.style.top="-5000px";d[b].el.style.left="-5000px";d[b].world._pool[d[b].world._pool.length]=d.splice(b,1)[0];c._updateCacheLookup(a,!1);break}};c.getAllItemsByName=function(a,b){var c,d,g=[],f=b||this._records.list;c=0;for(d=f.length;c<d;c++)f[c].name===a&&(g[g.length]=f[c]);return g};c.getAllItemsByAttribute=function(a,b){var c,d,g=[],f=this._records.list,h=void 0!==b?b:null;c=0;for(d=f.length;c<d;c++)void 0!==f[c][a]&&!(null!==h&&f[c][a]!==h)&&(g[g.length]=f[c]);return g};c.updateItemPropsByName=
function(a,b){var c,d,g,f=this.getAllItemsByName(a);c=0;for(d=f.length;c<d;c++)for(g in b)b.hasOwnProperty(g)&&(f[c][g]=b[g]);return f};c.getItem=function(a){var b,c,d=this._records.list;b=0;for(c=d.length;b<c;b+=1)if(d[b].id===a)return d[b];return null};c.updateItem=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};c._resize=function(){var a,b,c=this._records.list,d,f=this.getWindowSize(),i=this.firstWorld();this._resizeTime=(new Date).getTime();i.pauseStep=!0;a=0;for(b=c.length;a<
b;a++)d=c[a],"World"!==d.name&&(d.world.boundToWindow&&d.location)&&(d.location.x=f.width*(d.location.x/i.width),d.location.y=f.height*(d.location.y/i.height));i._setBounds()};c._keyup=function(a){var b=this._records.list[0];switch(a.keyCode){case 39:c._stepForward();break;case 80:b.pauseStep=!b.pauseStep;break;case 82:c._resetSystem();break;case 83:c._toggleStats()}};c.getNewId=function(){this._idCount++;return this._idCount};c._addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,
!1):a.attachEvent&&a.attachEvent("on"+b,c)};c._recordMouseLoc=function(a){var b;this.mouse.lastLocation.x=this.mouse.location.x;this.mouse.lastLocation.y=this.mouse.location.y;a.changedTouches&&(b=a.changedTouches[0]);a.pageX&&a.pageY?(this.mouse.location.x=a.pageX,this.mouse.location.y=a.pageY):a.clientX&&a.clientY?(this.mouse.location.x=a.clientX,this.mouse.location.y=a.clientY):b&&(this.mouse.location.x=b.pageX,this.mouse.location.y=b.pageY);this.mouse.velocity.x=this.mouse.lastLocation.x-this.mouse.location.x;
this.mouse.velocity.y=this.mouse.lastLocation.y-this.mouse.location.y};c.extend=function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a};c.getWindowSize=function(){var a={width:!1,height:!1};"undefined"!==typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientWidth?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):
"undefined"!==typeof document.body&&(a.width=document.body.clientWidth,a.height=document.body.clientHeight);return a};c.updateOrientation=function(){setTimeout(function(){c._records.list[0]._setBounds()},500)};c.getRandomNumber=function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a};c._toggleStats=function(){c._statsDisplay?c._statsDisplay&&c._statsDisplay._active?c._statsDisplay.destroy():c._statsDisplay&&!c._statsDisplay._active&&(c._statsDisplay=new d.StatsDisplay):
c._statsDisplay=new d.StatsDisplay};c._getSupportedFeatures=function(){return window.Modernizr?{csstransforms3d:Modernizr.csstransforms3d,csstransforms:Modernizr.csstransforms}:{csstransforms3d:d.FeatureDetector.detect("csstransforms3d"),csstransforms:d.FeatureDetector.detect("csstransforms")}};c._draw=function(a){var b=d.System.getCSSText({x:a.location.x-a.width/2,y:a.location.y-a.height/2,angle:a.angle,scale:a.scale||1,width:a.width,height:a.height,color0:a.color[0],color1:a.color[1],color2:a.color[2],
colorMode:a.colorMode,visibility:a.visibility,opacity:a.opacity,zIndex:a.zIndex,borderWidth:a.borderWidth,borderStyle:a.borderStyle,borderColor0:a.borderColor[0],borderColor1:a.borderColor[1],borderColor2:a.borderColor[2],borderRadius:a.borderRadius,boxShadowOffsetX:a.boxShadowOffset.x,boxShadowOffsetY:a.boxShadowOffset.y,boxShadowBlur:a.boxShadowBlur,boxShadowSpread:a.boxShadowSpread,boxShadowColor0:a.boxShadowColor[0],boxShadowColor1:a.boxShadowColor[1],boxShadowColor2:a.boxShadowColor[2]});a.el.style.cssText=
b};c.getCSSText=function(a){return this._stylePosition.replace(/<x>/g,a.x).replace(/<y>/g,a.y).replace(/<angle>/g,a.angle).replace(/<scale>/g,a.scale)+"width: "+a.width+"px; height: "+a.height+"px; background-color: "+a.colorMode+"("+a.color0+", "+a.color1+("hsl"===a.colorMode?"%":"")+", "+a.color2+("hsl"===a.colorMode?"%":"")+"); border: "+a.borderWidth+"px "+a.borderStyle+" "+a.colorMode+"("+a.borderColor0+", "+a.borderColor1+("hsl"===a.colorMode?"%":"")+", "+a.borderColor2+("hsl"===a.colorMode?
"%":"")+"); border-radius: "+a.borderRadius+"%; box-shadow: "+a.boxShadowOffsetX+"px "+a.boxShadowOffsetY+"px "+a.boxShadowBlur+"px "+a.boxShadowSpread+"px "+a.colorMode+"("+a.boxShadowColor0+", "+a.boxShadowColor1+("hsl"===a.colorMode?"%":"")+", "+a.boxShadowColor2+("hsl"===a.colorMode?"%":"")+"); visibility: "+a.visibility+"; opacity: "+a.opacity+"; z-index: "+a.zIndex+";"};d.System=c;m.prototype.step=function(){};m.prototype.draw=function(){d.System._draw(this)};m.prototype._setBounds=function(){var a=
d.System.getWindowSize();this.boundToWindow?(this.bounds=[0,a.width,a.height,0],this.width=a.width,this.height=a.height):this.bounds=[0,this.width,this.height,0];this.location=new d.Vector(a.width/2,a.height/2)};d.World=m;d.System.extend(o,d.Item);o.prototype.init=function(a){this.width=a.width||20;this.height=a.height||20;this.color=a.color||[100,100,100];this.borderRadius=a.borderRadius||0};d.Box=o;d.System.extend(p,d.Item);p.prototype.init=function(a){this.width=a.width||20;this.height=a.height||
20;this.color=a.color||[0,0,0];this.colorMode=a.colorMode||"rgb";this.borderRadius=a.borderRadius||100;this.opacity=a.opacity||1;this.boxShadowOffset=a.boxShadowOffset||new d.Vector;this.boxShadowBlur=a.boxShadowBlur||0;this.boxShadowSpread=a.boxShadowSpread||0;this.boxShadowColor=a.boxShadowColor||[0,0,0]};d.Ball=p})(exports);

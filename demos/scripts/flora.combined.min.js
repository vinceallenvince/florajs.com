/*
Burner
Copyright (c) 2013 Vince Allen | vince@vinceallen.com | http://www.vinceallen.com | florajs.com/license
*/
/* Version: 1.0.1 */
/* Build time: May 4, 2013 02:32:05 */function Burner(e,q){function n(a){this.options=a||{};this.name=this.options.name||"Element";this.id=this.name+e.System._getNewId();return this}function f(a,b){this.x=a||0;this.y=b||0}function l(){}function m(){var a,b;this._active=!0;this._fps=0;this._timeLastSecond=this._timeLastFrame=this._time=Date.now?Date.now():0;this._frameCount=0;this.el=document.createElement("div");this.el.id="statsDisplay";this.el.className="statsDisplay";this.el.style.color="white";this._fpsValue=this._totalElementsValue=
null;a=document.createElement("span");a.className="statsDisplayLabel";b=document.createTextNode("trans3d: ");a.appendChild(b);this.el.appendChild(a);this._3dTransformsValue=document.createTextNode(e.System.supportedFeatures.csstransforms3d);this.el.appendChild(this._3dTransformsValue);a=document.createElement("span");a.className="statsDisplayLabel";b=document.createTextNode("total elements: ");a.appendChild(b);this.el.appendChild(a);this._totalElementsValue=document.createTextNode("0");this.el.appendChild(this._totalElementsValue);
a=document.createElement("span");a.className="statsDisplayLabel";b=document.createTextNode("fps: ");a.appendChild(b);this.el.appendChild(a);this._fpsValue=document.createTextNode("0");this.el.appendChild(this._fpsValue);document.body.appendChild(this.el);this._update(this)}function d(){this.name="system"}function i(a){if(!a||"object"!==e.Utils.getDataType(a))throw Error('World: A valid DOM object is required for the new World\'s "el" property.');this.el=a;this.name="world";this.id=this.name+e.System._getNewId();
this.bounds=this._getBounds();this.pauseDraw=this.pauseStep=!1;this.style={};this.gravity=new e.Vector(0,1);this.c=0.1;this.position="absolute";this.left=this.top=0;this.location=new e.Vector;this.opacity=1;this.visibility="visible";this.angle=0;this.scale=1;this.borderColor=this.color="transparent";this.borderStyle="none";this.borderWidth="1";this.world={};this._pool=[]}var p=q||null;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};e.PubSub={subscribe:function(a,b){this._callbacks||(this._callbacks={});(this._callbacks[a]||(this._callbacks[a]=[])).push(b);return this},publish:function(){var a=Array.prototype.slice.call(arguments,0),b=a.shift(),c,d;if(!this._callbacks||!(c=this._callbacks[b]))return this;b=0;for(d=c.length;b<d;b+=1)c[b].apply(this,a);return this}};e.Utils={addEvent:function(a,b,c){a.addEventListener?this.addEventHandler=
function(a,b,c){a.addEventListener(b,c,!1)}:a.attachEvent&&(this.addEventHandler=function(a,b,c){a.attachEvent("on"+b,c)});this.addEventHandler(a,b,c)},getRandomNumber:function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a},getWindowSize:function(){var a={width:!1,height:!1};"undefined"!==typeof window.innerWidth?a.width=window.innerWidth:"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientWidth?a.width=document.documentElement.clientWidth:
"undefined"!==typeof document.body&&(a.width=document.body.clientWidth);"undefined"!==typeof window.innerHeight?a.height=window.innerHeight:"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientHeight?a.height=document.documentElement.clientHeight:"undefined"!==typeof document.body&&(a.height=document.body.clientHeight);return a},clone:function(a){function b(){}b.prototype=a;return new b},extend:function(a,b){function c(){}c.prototype=b.prototype;a.prototype=
new c;a.prototype.constructor=a},getDataType:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":typeof a}};n.prototype._init=function(){var a,b=this.options;if(!b.world||"object"!==e.Utils.getDataType(b.world))throw Error("Element: A valid world object is required for a new Element.");for(a in b)b.hasOwnProperty(a)&&(this[a]="function"===e.Utils.getDataType(b[a])?b[a]():b[a]);this.el.style.top=0;this.el.style.left=
0};n.prototype.draw=function(){var a,b=this.el;b&&(a=this._getCSSText({x:this.location.x-this.width/2,y:this.location.y-this.height/2,width:this.width,height:this.height,color:this.color,visibility:this.visibility}),b.style.cssText=a);return a};n.prototype._getCSSText=function(a){var b;b=e.System;b=b.supportedFeatures.csstransforms3d?["-webkit-transform: translate3d("+a.x+"px, "+a.y+"px, 0)","-moz-transform: translate3d("+a.x+"px, "+a.y+"px, 0)","-o-transform: translate3d("+a.x+"px, "+a.y+"px, 0)",
"-ms-transform: translate3d("+a.x+"px, "+a.y+"px, 0)"].join(";"):b.supportedFeatures.csstransforms?["-webkit-transform: translateX("+a.x+"px) translateY("+a.y+"px)","-moz-transform: translateX("+a.x+"px) translateY("+a.y+"px)","-o-transform: translateX("+a.x+"px) translateY("+a.y+"px)","-ms-transform: translateX("+a.x+"px) translateY("+a.y+"px)"].join(";"):["position: absolute","left: "+a.x+"px","top: "+a.y+"px"].join(";");a.background="array"===e.Utils.getDataType(a.color)?"rgb("+a.color[0]+", "+
a.color[1]+", "+a.color[2]+")":"transparent";return[b,"width: "+a.width+"px","height: "+a.height+"px","background-color: "+a.background,"visibility: "+a.visibility].join(";")};e.Element=n;f.VectorSub=function(a,b){return new f(a.x-b.x,a.y-b.y)};f.VectorAdd=function(a,b){return new f(a.x+b.x,a.y+b.y)};f.VectorMult=function(a,b){return new f(a.x*b,a.y*b)};f.VectorDiv=function(a,b){return new f(a.x/b,a.y/b)};f.VectorDistance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))};f.VectorMidPoint=
function(a,b){return f.VectorAdd(a,b).div(2)};f.VectorAngleBetween=function(a,b){var c=a.dot(b);return Math.acos(c/(a.mag()*b.mag()))};f.prototype.name="Vector";f.prototype.clone=function(){function a(){}a.prototype=this;return new a};f.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};f.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};f.prototype.mult=function(a){this.x*=a;this.y*=a;return this};f.prototype.div=function(a){this.x/=a;this.y/=a;return this};f.prototype.mag=
function(){return Math.sqrt(this.x*this.x+this.y*this.y)};f.prototype.limit=function(a){this.mag()>a&&(this.normalize(),this.mult(a));return this};f.prototype.normalize=function(){var a=this.mag();if(0!==a)return this.div(a)};f.prototype.distance=function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,2))};f.prototype.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.x,d=this.y;this.x=c*b-d*a;this.y=c*a+d*b;return this};f.prototype.midpoint=function(a){return f.VectorAdd(this,
a).div(2)};f.prototype.dot=function(a){return this.z&&a.z?this.x*a.x+this.y*a.y+this.z*a.z:this.x*a.x+this.y*a.y};e.Vector=f;l.detect=function(a){return!this[a]?!1:this[a].call(this)};l.csstransforms=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translateX(1px) translateY(1px);-moz-transform: translateX(1px) translateY(1px);-o-transform: translateX(1px) translateY(1px);-ms-transform: translateX(1px) translateY(1px)";
for(var a=[b.style.transform,b.style.webkitTransform,b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,c=0;c<a.length;c+=1)if(a[c]){b=!0;break}return b};l.csstransforms3d=function(){var a=document.createDocumentFragment(),b=document.createElement("div");a.appendChild(b);b.style.cssText="-webkit-transform: translate3d(1px, 1px, 0);-moz-transform: translate3d(1px, 1px, 0);-o-transform: translate3d(1px, 1px, 0);-ms-transform: translate3d(1px, 1px, 0)";for(var a=[b.style.transform,b.style.webkitTransform,
b.style.MozTransform,b.style.OTransform,b.style.msTransform],b=!1,c=0;c<a.length;c+=1)if(a[c]){b=!0;break}return b};l.touch=function(){var a=document.createElement("div");a.setAttribute("ongesturestart","return;");return"function"===typeof a.ongesturestart?!0:!1};e.FeatureDetector=l;m.prototype.getFPS=function(){return this._fps};m.prototype._update=function(a){var b=e.System.count();a._time=Date.now?Date.now():0;a._frameCount++;a._time>a._timeLastSecond+1E3&&(a._fps=a._frameCount,a._timeLastSecond=
a._time,a._frameCount=0,a._fpsValue.nodeValue=a._fps,a._totalElementsValue.nodeValue=b,a._3dTransformsValue.nodeValue=e.System.supportedFeatures.csstransforms3d);var c=this;this._active&&window.requestAnimFrame(function(){c._update(c)})};m.prototype.destroy=function(){this._active=!1;document.getElementById(this.el.id)&&document.body.removeChild(this.el)};m.prototype.name="StatsDisplay";e.StatsDisplay=m;d._records={lookup:{},list:[]};d._worldsCache={lookup:{},list:[]};d._Caches={};d._idCount=0;d.mouse=
{location:new e.Vector,lastLocation:new e.Vector,velocity:new e.Vector};d._resizeTime=0;d.create=function(a,b,c,h){var o,j=this._records.list,a=a||function(){},f,g=e.Utils,k=d.allWorlds(),i=d._worldsCache.lookup;d._setup=a;d._worlds=b;d._noStart=h;if(c)if("object"===g.getDataType(c))this.supportedFeatures=c;else throw Error("System: supportedFeatures should be passed as an object.");else this.supportedFeatures=d._getSupportedFeatures();if(b)if("object"===g.getDataType(b))j[j.length]=new e.World(b),
k[k.length]=j[j.length-1],i[k[k.length-1].id]=!0;else{if("array"===g.getDataType(b)&&b.length){c=0;for(o=b.length;c<o;c++)if((f=b[c])&&"object"===g.getDataType(f))j[j.length]=new e.World(f),k[k.length]=j[j.length-1],i[k[k.length-1].id]=!0}}else j[j.length]=new e.World(document.body),k[k.length]=j[j.length-1],i[k[k.length-1].id]=!0;"function"===g.getDataType(a)&&a.call(this);h||this._update();e.Utils.addEvent(document,"mousemove",function(a){d._recordMouseLoc.call(d,a)});e.Utils.addEvent(window,"touchstart",
function(a){d._recordMouseLoc.call(d,a)});e.Utils.addEvent(window,"touchmove",function(a){d._recordMouseLoc.call(d,a)});e.Utils.addEvent(window,"touchend",function(a){d._recordMouseLoc.call(d,a)});e.Utils.addEvent(window,"resize",function(a){d._resize.call(d,a)});return d.allElements()};d._getNewId=function(){this._idCount++;return this._idCount};d._getIdCount=function(){return this._idCount};d._update=function(){var a,b,c=this.allElements(),d=this.allWorlds();if(this._resizeTime&&100<(new Date).getTime()-
this._resizeTime){a=this._resizeTime=0;for(b=d.length;a<b;a+=1)d[a].pauseStep=!1}for(a=c.length-1;0<=a;a-=1)b=c[a],b.step&&!b.world.pauseStep&&b.step();for(a=c.length-1;0<=a;a-=1)b=c[a],b.draw&&!b.world.pauseDraw&&b.draw();var e=this;window.requestAnimFrame(function(){e._update(e)})};d.getWorld=function(a){for(var b=this._records.list,c=0,d=b.length;c<d;c++)if(b[c].el===a)return b[c];return null};d.allWorlds=function(){return this._worldsCache.list};d.hasWorld=function(a){return d._worldsCache.lookup[a]};
d.start=function(){this._update()};d.updateCache=function(a){var b=d._Caches[a.name]||(d._Caches[a.name]={lookup:{},list:[]});b.list[b.list.length]=a;b.lookup[a.id]=!0;return b};d._updateCacheLookup=function(a,b){var c=d._Caches[a.name];c&&(c.lookup[a.id]=b)};d.add=function(a,b){var c=b||{},h=this.allElements(),o=this._records.lookup,j=null,f;!c.world||"object"!==e.Utils.getDataType(c.world)?c.world=h[0]:(f=c.world.el?c.world.el:c.world,c.world=d.getWorld(f));if(this.getAllElementsByName(a,c.world._pool).length){f=
0;for(var g=c.world._pool.length;f<g;f++)if(c.world._pool[f].name===a){h[h.length]=c.world._pool.splice(f,1)[0];h[h.length-1].options=c;d._updateCacheLookup(h[h.length-1],!0);break}}else h[h.length]=p&&p[a]?new p[a](c):new e[a](c);h[h.length-1]._init&&h[h.length-1]._init();h[h.length-1].el&&(j=h[h.length-1].el.parentNode);o[h[h.length-1].id]=j;return this.lastElement()};d.count=function(){return this._records.list.length};d.hasElement=function(a){return d._records.lookup[a]};d.allElements=function(){return this._records.list};
d.firstElement=function(){return this._records.list[0]};d.lastElement=function(){return this._records.list[this._records.list.length-1]};d.getAllElementsByName=function(a,b){var c,d,e=[],f=b||this._records.list;c=0;for(d=f.length;c<d;c++)f[c].name===a&&(e[e.length]=f[c]);return e};d.getAllElementsByAttribute=function(a,b){var c,d,e=[],f=void 0!==b?b:null;c=0;for(d=this._records.list.length;c<d;c++)void 0!==this._records.list[c][a]&&!(null!==f&&this._records.list[c][a]!==f)&&(e[e.length]=this._records.list[c]);
return e};d.updateElementPropsByName=function(a,b){var c,d,e,f=this.getAllElementsByName(a);c=0;for(d=f.length;c<d;c++)for(e in b)b.hasOwnProperty(e)&&(f[c][e]=b[e]);return f};d.getElement=function(a){var b,c,d=this._records;b=0;for(c=d.list.length;b<c;b+=1)if(d.list[b].id===a)return d.list[b];return null};d.updateElement=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};d.destroyElement=function(a){var b,c,e=this._records.list;b=0;for(c=e.length;b<c;b+=1)if(e[b].id===a.id){e[b].el.style.visibility=
"hidden";e[b].el.style.top="-5000px";e[b].el.style.left="-5000px";e[b].world._pool[e[b].world._pool.length]=e.splice(b,1)[0];d._updateCacheLookup(a,!1);break}};d._getSupportedFeatures=function(){return window.Modernizr?{csstransforms3d:Modernizr.csstransforms3d,csstransforms:Modernizr.csstransforms}:{csstransforms3d:e.FeatureDetector.detect("csstransforms3d"),csstransforms:e.FeatureDetector.detect("csstransforms")}};d._recordMouseLoc=function(a){var b;this.mouse.lastLocation.x=this.mouse.location.x;
this.mouse.lastLocation.y=this.mouse.location.y;a.changedTouches&&(b=a.changedTouches[0]);a.pageX&&a.pageY?(this.mouse.location.x=a.pageX,this.mouse.location.y=a.pageY):a.clientX&&a.clientY?(this.mouse.location.x=a.clientX,this.mouse.location.y=a.clientY):b&&(this.mouse.location.x=b.pageX,this.mouse.location.y=b.pageY);this.mouse.velocity.x=this.mouse.lastLocation.x-this.mouse.location.x;this.mouse.velocity.y=this.mouse.lastLocation.y-this.mouse.location.y;return this.mouse};d._resize=function(){var a,
b,c,d=this.allElements(),f;a=e.Utils.getWindowSize();var j=a.width,i=a.height,g=this.allWorlds();this._resizeTime=(new Date).getTime();a=0;for(b=g.length;a<b;a+=1)g[a].pauseStep=!0;a=0;for(b=d.length;a<b;a+=1)f=d[a],"world"!==f.name&&(c=f.location,f=f.world,c&&(c.x=j*(c.x/f.bounds[1]),c.y=i*(c.y/f.bounds[2])));a=0;for(b=g.length;a<b;a+=1)g[a].bounds=g[a]._getBounds()};d._pause=function(a){var b,c=[];a?"object"===e.Utils.getDataType(a)?c.push(d.getWorld(c)):"array"===e.Utils.getDataType(a)&&(c=a):
c=d.allWorlds();a=0;for(b=c.length;a<b;a++)c[a].pauseStep=!c[a].pauseStep,c[a].pauseDraw=!c[a].pauseDraw};d._resetSystem=function(){d._destroySystem(!0);d._setup.call(d)};d._destroyAllElements=function(){var a,b=d.allElements();for(a=b.length-1;0<=a;a--)d.hasWorld([b[a].id])||b.splice(a,1)};d._destroySystem=function(a){var b,c,f=d.allWorlds();d.allElements();var i=a||!1,a=0;for(b=f.length;a<b;a++){f[a].pauseStep=!1;f[a].pauseDraw=!1;for(c=f[a].el;c.firstChild;)c.removeChild(c.firstChild);i||c.parentNode.removeChild(c)}i?
d._destroyAllElements():(d._records={lookup:{},list:[]},d._worldsCache={lookup:{},list:[]},d._idCount=0);d.mouse={location:new e.Vector,lastLocation:new e.Vector,velocity:new e.Vector};d._resizeTime=0;d._statsDisplay&&(d._statsDisplay.destroy(),d._statsDisplay=null)};d._stats=function(){d._statsDisplay?(d._statsDisplay.destroy(),d._statsDisplay=null):d._statsDisplay=new e.StatsDisplay};e.PubSub.subscribe("pause",d._pause);e.PubSub.subscribe("resetSystem",d._resetSystem);e.PubSub.subscribe("destroyAllElements",
d._destroyAllElements);e.PubSub.subscribe("destroySystem",d._destroySystem);e.PubSub.subscribe("stats",d._stats);e.PubSub.subscribe("UpdateCache",d.updateCache);e.System=d;i.prototype.step=function(){};i.prototype.draw=function(){var a,b=this.el;b&&(a=this._getCSSText({x:this.location.x,y:this.location.y,width:this.bounds[1],height:this.bounds[2],opacity:this.opacity,visibility:this.visibility,a:this.angle,s:this.scale,color:this.color,borderColor:this.borderColor,borderStyle:this.borderStyle,borderWidth:this.borderWidth}),
b.style.cssText=a);return a};i.prototype._getCSSText=function(a){var b,c,d;b=e.System;c=e.Utils;d=b.supportedFeatures.csstransforms3d?["-webkit-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-moz-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+
a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):b.supportedFeatures.csstransforms?["-webkit-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-moz-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+
"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):["position: absolute","left: "+a.x+"px","top: "+a.y+"px"].join(";");b="rgb("+a.color[0]+", "+a.color[1]+", "+a.color[2]+")";c="array"===c.getDataType(a.borderColor)?"rgb("+a.borderColor[0]+", "+a.borderColor[1]+", "+a.borderColor[2]+")":a.borderColor;return[d,"width: "+a.width+"px","height: "+a.height+"px","opacity: "+a.opacity,"visibility: "+a.visibility,"background-color: "+b,"border-color: "+c,"border-style: "+a.borderStyle,"border-width: "+a.borderWidth+
"px"].join(";")};i.update=function(a,b,c){var f,i,j,l=e.Utils,g=[],k="object"===l.getDataType(a)?a:{},m=e.Utils.getWindowSize();if(b)if("object"===l.getDataType(b))g[g.length]=d.getWorld(b);else{if("array"===l.getDataType(b)&&b.length){a=0;for(f=b.length;a<f;a++)j=b[a],"object"===l.getDataType(j)&&(g[g.length]=d.getWorld(j))}}else g[g.length]=e.System._records.list[0];a=0;for(f=g.length;a<f;a++){for(i in k)k.hasOwnProperty(i)&&(g[a][i]=k[i]);g[a]._applyStyles();g[a].bounds=g[a]._getBounds();c&&(g[a].location=
new e.Vector(m.width/2-g[a].bounds[1]/2,m.height/2-g[a].bounds[2]/2))}};i.prototype._applyStyles=function(){for(var a in this.style)this.style.hasOwnProperty(a)&&(this.el.style[a]=this.style[a])};i.prototype._getBounds=function(){var a;if(this.width&&this.height)return[0,this.width,this.height,0];a=this.el===document.body?e.Utils.getWindowSize():{width:this.el.offsetWidth,height:this.el.offsetHeight};return[0,a.width,a.height,0]};e.World=i};
/*
FloraJS
Copyright (c) 2013 Vince Allen | vince@vinceallen.com | http://www.vinceallen.com | florajs.com/license
*/
/* Version: 1.0.1 */
/* Build time: May 4, 2013 03:33:19 */var Flora={},exports=Flora;
(function(b){function i(a,c){this.x=a||0;this.y=c||0}function r(a){this._borders=[];this.id=a||r._idCount;r._idCount+=1}function l(a){this._gradients=[];this._colors=[];this.id=a||l._idCount;l._idCount+=1}function z(){}function E(a){var a=a||{},c,e;this.world=a.world||b.System.allWorlds()[0];this.position=a.position||"top left";this.text=a.text||"";this.opacity=0===a.opacity?0:a.opacity||0.75;this.color=a.color||[255,255,255];this.borderWidth=a.borderWidth||"1px";this.borderStyle=a.borderStyle||"solid";
this.borderColor=a.borderColor||[204,204,204];this.colorMode=a.colorMode||"rgb";this.el=document.createElement("div");this.el.id="caption";this.el.className="caption ";e=this.position.split(" ");a=0;for(c=e.length;a<c;a++)this.el.className=this.el.className+"caption"+b.Utils.capitalizeFirstLetter(e[a])+" ";this.el.style.opacity=this.opacity;this.el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+", "+this.color[2]+")";this.el.style.borderWidth=this.borderWidth;this.el.style.borderStyle=
this.borderStyle;this.el.style.borderColor="string"===typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")";this.el.appendChild(document.createTextNode(this.text));document.getElementById("caption")&&document.getElementById("caption").parentNode.removeChild(document.getElementById("caption"));this.world.el.appendChild(this.el)}function F(a){var c=this,a=a||{},e,d;this.world=a.world||b.universe.first();this.position=a.position||
"top left";this.opacity=0===a.opacity?0:a.opacity||0.75;this.color=a.color||[255,255,255];this.borderWidth=a.borderWidth||"1px";this.borderStyle=a.borderStyle||"solid";this.borderColor=a.borderColor||[204,204,204];this.colorMode=a.colorMode||"rgb";this.text=b.Burner.System.supportedFeatures.touch?b.config.touchMap.stats+"-finger tap = stats | "+b.config.touchMap.pause+"-finger tap = pause | "+b.config.touchMap.reset+"-finger tap = reset":"'"+String.fromCharCode(b.config.keyMap.pause).toLowerCase()+
"' = pause | '"+String.fromCharCode(b.config.keyMap.resetSystem).toLowerCase()+"' = reset | '"+String.fromCharCode(b.config.keyMap.stats).toLowerCase()+"' = stats";this.el=document.createElement("div");this.el.id="inputMenu";this.el.className="inputMenu ";d=this.position.split(" ");a=0;for(e=d.length;a<e;a++)this.el.className=this.el.className+"inputMenu"+b.Utils.capitalizeFirstLetter(d[a])+" ";this.el.style.opacity=this.opacity;this.el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+
", "+this.color[2]+")";this.el.style.borderWidth=this.borderWidth;this.el.style.borderStyle=this.borderStyle;this.el.style.borderColor="string"===typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")";this.el.appendChild(document.createTextNode(this.text));document.getElementById("inputMenu")&&document.getElementById("inputMenu").parentNode.removeChild(document.getElementById("inputMenu"));b.Burner.System.supportedFeatures.touch?
b.Utils.addEvent(this.el,"touchstart",function(){c.destroy()}):b.Utils.addEvent(this.el,"mouseup",function(){c.destroy()});this.world.el.appendChild(this.el)}function k(a){var c;c=b.Burner.Utils;a.name=this.name;b.Burner.Element.call(this,a);this.options=a=a||{};this.world=a.world;this.width=a.width||20;this.height=a.height||20;this.mass=a.mass||10;this.bounciness=a.bounciness||0.75;this.opacity=0===a.opacity?0:a.opacity||1;this.visibility=a.visibility||"visible";this.maxSpeed=0===a.maxSpeed?0:a.maxSpeed||
10;this.minSpeed=a.minSpeed||0;this.motorSpeed=a.motorSpeed||0;this.pointToDirection=a.pointToDirection||!0;this.acceleration="function"===c.getDataType(a.acceleration)?a.acceleration():a.acceleration||new b.Vector;this.velocity="function"===c.getDataType(a.velocity)?a.velocity():a.velocity||new b.Vector;this.location="function"===c.getDataType(a.location)?a.location():a.location||new b.Vector(this.world.bounds[1]/2,this.world.bounds[2]/2);this.angle=a.angle||0;this.scale=a.scale||1;this.borderWidth=
a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||"transparent";this.borderRadius=a.borderRadius||0;this.borderTopWidth=a.borderTopWidth||0;this.borderTopStyle=a.borderTopStyle||"none";this.borderTopColor=a.borderTopColor||"transparent";this.borderRightWidth=a.borderRightWidth||0;this.borderRightStyle=a.borderRightStyle||"none";this.borderRightColor=a.borderRightColor||"transparent";this.borderBottomWidth=a.borderBottomWidth||0;this.borderBottomStyle=a.borderBottomStyle||
"none";this.borderBottomColor=a.borderBottomColor||"transparent";this.borderLeftWidth=a.borderLeftWidth||0;this.borderLeftStyle=a.borderLeftStyle||"none";this.borderLeftColor=a.borderLeftColor||"transparent";this.borderTopLeftRadius=a.borderTopLeftRadius||"100%";this.borderTopRightRadius=a.borderTopRightRadius||"100%";this.borderBottomRightRadius=a.borderBottomRightRadius||"100%";this.borderBottomLeftRadius=a.borderBottomLeftRadius||"100%";this.isStatic=!!a.isStatic;this.draggable=!!a.draggable;this.controlCamera=
!!a.controlCamera;this.checkEdges=a.checkEdges||!0;this.wrapEdges=a.wrapEdges||!1;this.avoidEdges=!!a.avoidEdges;this.avoidEdgesStrength=a.avoidEdgesStrength||50;this.pointToDirection=!1===a.pointToDirection?!1:!0;this.lifespan=0===a.lifespan?0:a.lifespan||-1;this.life=0===a.life?0:a.life||-1;this.parent=a.parent||null;this.offsetDistance=a.offsetDistance||30;this.beforeStep=a.beforeStep||null;this.afterStep=a.afterStep||null;this._forceVector=new b.Vector;this.checkCameraEdgesVector=new b.Vector;
this.cameraDiffVector=new b.Vector;this.clock=0;this.viewArgs=a.viewArgs||[];c=document.createElement("div");this.el=a.view&&"function"===b.Interface.getDataType(a.view)?a.view.apply(this,this.viewArgs):"object"===b.Interface.getDataType(a.view)?a.view:c;this.el.id=this.id;this.el.className=this.options.sensors?"element "+this.name.toLowerCase()+" hasSensor":"element "+this.name.toLowerCase();this.el.style.visibility="hidden";this.options.world.el.appendChild(this.el);this.isPressed=this.isMouseOut=
!1;var e=this,a=function(a){e.mouseover(a,e)},d=this;c=function(a){d.mousedown(a,d)};var f,h=this;f=function(a){h.mousemove(a,h)};var g,j=this;g=function(a){j.mouseup(a,j)};var p,i=this;p=function(a){i.mouseout(a,i)};this.draggable&&(b.Utils.addEvent(this.el,"mouseover",a),b.Utils.addEvent(this.el,"mousedown",c),b.Utils.addEvent(this.el,"mousemove",f),b.Utils.addEvent(this.el,"mouseup",g),b.Utils.addEvent(this.el,"mouseout",p))}function m(a){a.name=this.name;b.Mover.call(this,a);a=a||{};this.followMouse=
!!a.followMouse;this.maxSteeringForce=a.maxSteeringForce||10;this.seekTarget=a.seekTarget||null;this.flocking=!!a.flocking;this.desiredSeparation=0===a.desiredSeparation?0:a.desiredSeparation||2*this.width;this.separateStrength=0===a.separateStrength?0:a.separateStrength||0.3;this.alignStrength=0===a.alignStrength?0:a.alignStrength||0.2;this.cohesionStrength=0===a.cohesionStrength?0:a.cohesionStrength||0.1;this.flowField=a.flowField||null;this.sensors=a.sensors||[];this.color=a.color||[197,177,115];
this.borderWidth=a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||"transparent";this.borderRadius=a.borderRadius||null;this.borderTopLeftRadius=a.borderTopLeftRadius||"0";this.borderTopRightRadius=a.borderTopRightRadius||"0";this.borderBottomRightRadius=a.borderBottomRightRadius||"0";this.borderBottomLeftRadius=a.borderBottomLeftRadius||"0";this.separateSumForceVector=new b.Vector;this.alignSumForceVector=new b.Vector;this.cohesionSumForceVector=new b.Vector;
this.followTargetVector=new b.Vector;this.followDesiredVelocity=new b.Vector}function A(a){a.name=this.name;b.Mover.call(this,a);a=a||{};this.width=a.width||10;this.height=a.height||10;this.perlin=a.perlin||!0;this.remainsOnScreen=!!a.remainsOnScreen;this.perlinSpeed=a.perlinSpeed||0.0050;this.perlinTime=a.perlinTime||0;this.perlinAccelLow=a.perlinAccelLow||-0.075;this.perlinAccelHigh=a.perlinAccelHigh||0.075;this.offsetX=a.offsetX||1E4*Math.random();this.offsetY=a.offsetY||1E4*Math.random();this.random=
!!a.random;this.randomRadius=a.randomRadius||100;this.color=a.color||[255,150,50];this.borderWidth=a.borderWidth||2;this.borderStyle=a.borderStyle||"solid";this.borderColor=a.borderColor||"white";this.borderRadius=a.borderRadius||"100%"}function s(a){a=a||{};b.Agent.call(this,a);this.type=a.type||"";this.behavior=a.behavior||"LOVE";this.sensitivity=0===a.sensitivity?0:a.sensitivity||2;this.width=0===a.width?0:a.width||7;this.height=0===a.height?0:a.height||7;this.offsetDistance=0===a.offsetDistance?
0:a.offsetDistance||30;this.offsetAngle=a.offsetAngle||0;this.opacity=0===a.opacity?0:a.opacity||0.75;this.target=a.target||null;this.activated=!!a.activated;this.activatedColor=a.activatedColor||[200,200,200];this.borderRadius="100%";this.borderWidth=2;this.borderStyle="solid";this.borderColor="white"}function G(a){a=a||{};b.Agent.call(this,a);this.c=0===a.c?0:a.c||1;this.mass=0===a.mass?0:a.mass||50;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?0:a.width||100;this.height=
0===a.height?0:a.height||100;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[105,210,231];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[167,219,216];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function H(a){a=a||{};b.Agent.call(this,a);this.mass=0===a.mass?0:a.mass||50;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?
0:a.width||50;this.height=0===a.height?0:a.height||50;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[255,69,0];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[224,178,154];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function I(a){a=a||{};b.Agent.call(this,a);this.mass=0===a.mass?0:a.mass||50;this.isStatic=!1===a.isStatic?!1:a.isStatic||
!0;this.width=0===a.width?0:a.width||50;this.height=0===a.height?0:a.height||50;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[132,192,201];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[0,89,102];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function J(a){a=a||{};b.Agent.call(this,a);this.mass=0===a.mass?0:a.mass||50;this.isStatic=!1===
a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?0:a.width||50;this.height=0===a.height?0:a.height||50;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[0,174,239];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[64,255,255];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function K(a){a=a||{};b.Agent.call(this,a);this.mass=0===a.mass?0:a.mass||
50;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?0:a.width||50;this.height=0===a.height?0:a.height||50;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[255,200,0];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[210,210,0];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function B(a){a=a||{};b.Agent.call(this,a);if(!a.parentA||
!a.parentB)throw Error("Connector: both parentA and parentB are required.");this.parentA=a.parentA;this.parentB=a.parentB;this.opacity=0===a.opacity?0:a.opacity||1;this.zIndex=a.zIndex||0;this.borderWidth=2;this.borderRadius="0%";this.borderStyle="none";this.borderColor="red";this.borderTopStyle="dotted";this.borderLeftStyle=this.borderBottomStyle=this.borderRightStyle="none";this.height=this.width=0;this.color="transparent"}function L(a){a=a||{};b.Agent.call(this,a);this.width=0===a.width?0:a.width||
10;this.height=0===a.height?0:a.height||10;this.opacity=0===a.opacity?0:a.opacity||1;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.zIndex=0===a.zIndex?0:a.zIndex||0;this.color=a.color||[200,200,200];this.borderRadius=a.borderRadius||"100%";this.borderWidth=a.borderWidth||2;this.borderStyle=a.borderStyle||"solid";this.borderColor=a.borderColor||[60,60,60]}function M(a){a=a||{};b.Agent.call(this,a);this.mass=0===a.mass?0:a.mass||50;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===
a.width?0:a.width||50;this.height=0===a.height?0:a.height||50;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[57,128,0];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[115,255,0];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function C(a){a=a||{};b.Agent.call(this,a);this.width=0===a.width?0:a.width||20;this.height=0===a.height?0:a.height||
20;this.lifespan=0===a.lifespan?0:a.lifespan||50;this.life=0===a.life?0:a.life||0;this.fade=!1===a.fade?!1:!0;this.shrink=!1===a.shrink?!1:!0;this.borderRadius=a.borderRadius||"100%";this.checkEdges=!!a.checkEdges;this.maxSpeed=a.maxSpeed||4;this.borderWidth=a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||"transparent";a.acceleration||(this.acceleration=new b.Vector(1,1),this.acceleration.normalize(),this.acceleration.mult(30),this.acceleration.rotate(b.Utils.getRandomNumber(0,
2*Math.PI,!0)));this.initWidth=this.width;this.initHeight=this.height;this.name="Particle"}function t(a){a=a||{};b.Agent.call(this,a);this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.lifespan=0===a.lifespan?0:a.lifespan||1E3;this.life=0===a.life?0:a.life||0;this.width=0===a.width?0:a.width||0;this.height=0===a.height?0:a.height||0;this.burst=0===a.burst?0:a.burst||1;this.burstRate=0===a.burstRate?0:a.burstRate||4;this.emitRadius=0===a.emitRadius?0:a.emitRadius||3;this.startColor=a.startColor||
[100,20,20];this.endColor=a.endColor||[255,0,0];this.particleOptions=a.particleOptions||{width:15,height:15,lifespan:50,borderRadius:"100%",checkEdges:!1,acceleration:null,velocity:null,location:null,maxSpeed:3,fade:!0};this.borderWidth=a.borderWidth||0;this.borderStyle=a.borderStyle||"none";this.borderColor=a.borderColor||"transparent";this.borderRadius=a.borderRadius||"0%";var c=new b.ColorPalette;c.addColor({min:12,max:24,startColor:this.startColor,endColor:this.endColor});this.beforeStep=function(){var a,
d,f=this.particleOptions.maxSpeed;if(this.life<this.lifespan)this.life+=1;else if(-1!==this.lifespan){b.Burner.System.destroyElement(this);return}if(0===this.clock%this.burstRate){a=this.getLocation();d=new b.Vector(1,1);d.normalize();d.mult(this.emitRadius);d.rotate(b.Utils.getRandomNumber(0,2*Math.PI,!0));a.add(d);for(d=0;d<this.burst;d++)this.particleOptions.world=this.world,this.particleOptions.life=0,this.particleOptions.color=c.getColor(),this.particleOptions.acceleration=new b.Vector(1,1),
this.particleOptions.acceleration.normalize(),this.particleOptions.acceleration.mult(f?f:3),this.particleOptions.acceleration.rotate(b.Utils.getRandomNumber(0,2*Math.PI,!0)),this.particleOptions.velocity=new b.Vector,this.particleOptions.location=t.getParticleLocation(a),b.Burner.System.add("Particle",this.particleOptions)}}}function D(a){a=a||{};b.Agent.call(this,a);this.initialLocation=a.initialLocation||new b.Vector(this.world.bounds[1]/2,this.world.bounds[2]/2);this.lastLocation=new b.Vector(0,
0);this.amplitude=a.amplitude||new b.Vector(this.world.bounds[1]/2-this.width,this.world.bounds[2]/2-this.height);this.acceleration=a.acceleration||new b.Vector(0.01,0);this.aVelocity=new b.Vector(0,0);this.isStatic=!!a.isStatic;this.isPerlin=!!a.isPerlin;this.perlinSpeed=a.perlinSpeed||0.0050;this.perlinTime=a.perlinTime||0;this.perlinAccelLow=a.perlinAccelLow||-2;this.perlinAccelHigh=a.perlinAccelHigh||2;this.perlinOffsetX=a.perlinOffsetX||1E4*Math.random();this.perlinOffsetY=a.perlinOffsetY||1E4*
Math.random();this.color=[200,100,0];this.borderBottomRightRadius=this.borderTopRightRadius="100%";this.borderStyle="solid";this.borderColor=[255,150,50]}function N(a){a=a||{};b.Agent.call(this,a);this.G=0===a.G?0:a.G||10;this.mass=0===a.mass?0:a.mass||1E3;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?0:a.width||100;this.height=0===a.height?0:a.height||100;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||10;this.color=a.color||[92,187,0];this.borderWidth=
a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[224,228,204];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function O(a){a=a||{};b.Agent.call(this,a);this.G=0===a.G?0:a.G||-10;this.mass=0===a.mass?0:a.mass||1E3;this.isStatic=!1===a.isStatic?!1:a.isStatic||!0;this.width=0===a.width?0:a.width||100;this.height=0===a.height?0:a.height||100;this.opacity=0===a.opacity?0:a.opacity||0.75;this.zIndex=0===a.zIndex?0:a.zIndex||
10;this.color=a.color||[250,105,0];this.borderWidth=a.borderWidth||"1em";this.borderStyle=a.borderStyle||"double";this.borderColor=a.borderColor||[224,228,204];this.borderRadius=a.borderRadius||"100%";b.Burner.PubSub.publish("UpdateCache",this)}function P(a){a=a||{};this.resolution=a.resolution||50;this.perlinSpeed=a.perlinSpeed||0.01;this.perlinTime=a.perlinTime||100;this.field=a.field||null;this.createMarkers=a.createMarkers||!1;this.world=a.world||b.Burner.System.allWorlds()[0]}function R(a){var c,
e;if(b.Interface.checkRequiredParams(a,{location:"object",scale:"number",angle:"number",opacity:"number",width:"number",height:"number",colorMode:"string",color:"array"}))return c=document.createElement("div"),e=document.createElement("div"),c.className="flowFieldMarker element",e.className="nose",c.appendChild(e),c.style.cssText=b.Mover._getCSSText({x:a.location.x-a.width/2,y:a.location.y-a.height/2,width:a.width,height:a.height,opacity:a.opacity,a:a.angle,s:a.scale,color:a.color,z:a.zIndex,borderRadius:a.borderRadius}),
c}b.Burner={};new Burner(b.Burner,b);var u={borderStyles:"none solid dotted dashed double inset outset groove ridge".split(" "),defaultColorList:[{name:"heat",startColor:[255,132,86],endColor:[175,47,0]},{name:"cold",startColor:[88,129,135],endColor:[171,244,255]},{name:"food",startColor:[186,255,130],endColor:[84,187,0]},{name:"oxygen",startColor:[109,215,255],endColor:[0,140,192]},{name:"light",startColor:[255,227,127],endColor:[189,148,0]}],keyMap:{pause:80,resetSystem:82,destroySystem:68,stats:83,
thrustLeft:37,thrustUp:38,thrustRight:39,thrustDown:40},touchMap:{stats:2,pause:3,reset:4}};b.config=u;b.Interface={checkRequiredParams:function(a,c,b){var d,f,h=!0;for(d in c)if(c.hasOwnProperty(d))try{if("undefined"===typeof a)throw Error("checkRequiredOptions: No options were passed.");if(!this.checkDataType(this.getDataType(a[d]),c[d].split("|"))||""===a[d])throw h=!1,f=""===a[d]?'checkRequiredOptions: required option "'+d+'" is empty.':"undefined"===typeof a[d]?'checkRequiredOptions: required option "'+
d+'" is missing from passed options.':'checkRequiredOptions: passed option "'+d+'" must be type '+c[d]+". Passed as "+this.getDataType(a[d])+".",Error(f);}catch(g){"undefined"!==typeof console&&console.log("ERROR: "+g.message+(b?" from: "+b:""))}return h},checkDataType:function(a,c){var b,d;b=0;for(d=c.length;b<d;b++)if(a===c[b])return!0;return!1},getDataType:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":
typeof a}};b.Utils={extend:function(a,c){function b(){}b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a},map:function(a,c,b,d,f){return(a-c)/(b-c)*(f-d)+d},getRandomNumber:function(a,c,b){return b?Math.random()*(c-(a-1))+a:Math.floor(Math.random()*(c-(a-1)))+a},degreesToRadians:function(a){if("undefined"!==typeof a)return 2*Math.PI*(a/360);"undefined"!==typeof console&&console.log("Error: Utils.degreesToRadians is missing degrees param.");return!1},radiansToDegrees:function(a){if("undefined"!==
typeof a)return a*(180/Math.PI);"undefined"!==typeof console&&console.log("Error: Utils.radiansToDegrees is missing radians param.");return!1},constrain:function(a,c,b){return a>b?b:a<c?c:a},clone:function(a){function c(){}c.prototype=a;return new c},addEvent:function(a,c,b){a.addEventListener?this.addEventHandler=function(a,c,b){a.addEventListener(c,b,!1)}:a.attachEvent&&(this.addEventHandler=function(a,c,b){a.attachEvent("on"+c,b)});this.addEventHandler(a,c,b)},log:function(a){"undefined"!==typeof console&&
"undefined"!==typeof console.log?(this.log=function(a){console.log(a)},this.log.call(this,a)):this.log=function(){}},getWindowSize:function(){var a={width:!1,height:!1};"undefined"!==typeof window.innerWidth?a.width=window.innerWidth:"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientWidth?a.width=document.documentElement.clientWidth:"undefined"!==typeof document.body&&(a.width=document.body.clientWidth);"undefined"!==typeof window.innerHeight?a.height=
window.innerHeight:"undefined"!==typeof document.documentElement&&"undefined"!==typeof document.documentElement.clientHeight?a.height=document.documentElement.clientHeight:"undefined"!==typeof document.body&&(a.height=document.body.clientHeight);return a},getDataType:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":typeof a},capitalizeFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},
isInside:function(a,c){return c&&a.location.x+a.width/2>c.location.x-c.width/2&&a.location.x-a.width/2<c.location.x+c.width/2&&a.location.y+a.height/2>c.location.y-c.height/2&&a.location.y-a.height/2<c.location.y+c.height/2?!0:!1},mouseIsInsideWorld:function(a){var c=b.Burner.System.mouse,e=c.location.x,c=c.location.y,d=a.el.offsetLeft,f=a.el.offsetTop;return a&&e>d&&e<d+a.bounds[1]&&c>f&&c<f+a.bounds[2]?!0:!1}};var v={random:function(){return 0.1}};void 0===v&&(v=Math);var n,Q=[];for(n=0;256>n;n+=
1)Q[n]=Math.floor(256*v.random());v=[];for(n=0;512>n;n+=1)v[n]=Q[n&255];b.SimplexNoise={grad3:[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],p:Q,perm:v,simplex:[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,
0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]],dot:function(a,c,b){return a[0]*c+a[1]*b},noise:function(a,c){var b,d,f;f=0.5*(Math.sqrt(3)-1);f*=a+c;var h=Math.floor(a+f),g=Math.floor(c+
f),j=(3-Math.sqrt(3))/6;f=(h+g)*j;b=a-(h-f);var p=c-(g-f),i,y;b>p?(i=1,y=0):(i=0,y=1);d=b-i+j;var o=p-y+j;f=b-1+2*j;var j=p-1+2*j,k=h&255,g=g&255,h=this.perm[k+this.perm[g]]%12;i=this.perm[k+i+this.perm[g+y]]%12;y=this.perm[k+1+this.perm[g+1]]%12;g=0.5-b*b-p*p;0>g?b=0:(g*=g,b=g*g*this.dot(this.grad3[h],b,p));p=0.5-d*d-o*o;0>p?d=0:(p*=p,d=p*p*this.dot(this.grad3[i],d,o));o=0.5-f*f-j*j;0>o?f=0:(o*=o,f=o*o*this.dot(this.grad3[y],f,j));return 70*(b+d+f)},noise3d:function(a,c,b){var d,f,h,g=(a+c+b)*(1/
3),j=Math.floor(a+g),p=Math.floor(c+g),i=Math.floor(b+g),g=1/6;h=(j+p+i)*g;d=a-(j-h);f=c-(p-h);var k=b-(i-h),o,l,x,m,q,n;d>=f?f>=k?(o=1,x=l=0,q=m=1,n=0):(d>=k?(o=1,x=l=0):(l=o=0,x=1),m=1,q=0,n=1):f<k?(l=o=0,x=1,m=0,n=q=1):d<k?(o=0,l=1,m=x=0,n=q=1):(o=0,l=1,x=0,q=m=1,n=0);var w=d-o+g,r=f-l+g,s=k-x+g;h=d-m+2*g;var a=f-q+2*g,v=k-n+2*g,b=d-1+3*g,c=f-1+3*g,g=k-1+3*g,j=j&255,t=p&255,u=i&255,p=this.perm[j+this.perm[t+this.perm[u]]]%12,i=this.perm[j+o+this.perm[t+l+this.perm[u+x]]]%12;m=this.perm[j+m+this.perm[t+
q+this.perm[u+n]]]%12;j=this.perm[j+1+this.perm[t+1+this.perm[u+1]]]%12;q=0.6-d*d-f*f-k*k;0>q?d=0:(q*=q,d=q*q*this.dot(this.grad3[p],d,f,k));f=0.6-w*w-r*r-s*s;0>f?f=0:(f*=f,f=f*f*this.dot(this.grad3[i],w,r,s));w=0.6-h*h-a*a-v*v;0>w?h=0:(w*=w,h=w*w*this.dot(this.grad3[m],h,a,v));a=0.6-b*b-c*c-g*g;0>a?b=0:(a*=a,b=a*a*this.dot(this.grad3[j],b,c,g));return 32*(d+f+h+b)}};i.VectorSub=function(a,c){return new i(a.x-c.x,a.y-c.y)};i.VectorAdd=function(a,c){return new i(a.x+c.x,a.y+c.y)};i.VectorMult=function(a,
c){return new i(a.x*c,a.y*c)};i.VectorDiv=function(a,c){return new i(a.x/c,a.y/c)};i.VectorDistance=function(a,c){return Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2))};i.VectorMidPoint=function(a,c){return i.VectorAdd(a,c).div(2)};i.VectorAngleBetween=function(a,c){var b=a.dot(c);return Math.acos(b/(a.mag()*c.mag()))};i.prototype.name="Vector";i.prototype.clone=function(){function a(){}a.prototype=this;return new a};i.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};i.prototype.sub=
function(a){this.x-=a.x;this.y-=a.y;return this};i.prototype.mult=function(a){this.x*=a;this.y*=a;return this};i.prototype.div=function(a){this.x/=a;this.y/=a;return this};i.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};i.prototype.limit=function(a,c){var b=a||null,d=c||null;b&&this.mag()>b&&(this.normalize(),this.mult(b));d&&this.mag()<d&&(this.normalize(),this.mult(d));return this};i.prototype.normalize=function(){var a=this.mag();if(0!==a)return this.div(a)};i.prototype.distance=
function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,2))};i.prototype.rotate=function(a){var c=Math.cos(a),a=Math.sin(a),b=this.x,d=this.y;this.x=b*c-d*a;this.y=b*a+d*c;return this};i.prototype.midpoint=function(a){return i.VectorAdd(this,a).div(2)};i.prototype.dot=function(a){return this.z&&a.z?this.x*a.x+this.y*a.y+this.z*a.z:this.x*a.x+this.y*a.y};b.Vector=i;r._idCount=0;r.prototype.name="BorderPalette";r.prototype.addBorder=function(a){var c,e;if(b.Interface.checkRequiredParams(a,
{min:"number",max:"number",style:"string"})){e=b.Utils.getRandomNumber(a.min,a.max);for(c=0;c<e;c++)this._borders.push(a.style)}return this};r.prototype.getBorder=function(){if(0<this._borders.length)return this._borders[b.Utils.getRandomNumber(0,this._borders.length-1)];throw Error("BorderPalette.getBorder: You must add borders via addBorder() before using getBorder().");};b.BorderPalette=r;l._idCount=0;l.prototype.name="ColorPalette";l.prototype.addColor=function(a){var c,e;if(b.Interface.checkRequiredParams(a,
{min:"number",max:"number",startColor:"array",endColor:"array"})){c=b.Utils.getRandomNumber(a.min,a.max);e=l._createColorRange(a.startColor,a.endColor,255);for(a=0;a<c;a++)this._colors.push(e[b.Utils.getRandomNumber(0,e.length-1)])}return this};l.prototype.createGradient=function(a){if(b.Interface.checkRequiredParams(a,{startColor:"array",endColor:"array"}))if(this.startColor=a.startColor,this.endColor=a.endColor,this.totalColors=a.totalColors||255,0<this.totalColors)this._gradients.push(l._createColorRange(this.startColor,
this.endColor,this.totalColors));else throw Error("ColorPalette: total colors must be greater than zero.");};l.prototype.getColor=function(){if(0<this._colors.length)return this._colors[b.Utils.getRandomNumber(0,this._colors.length-1)];throw Error("ColorPalette.getColor: You must add colors via addColor() before using getColor().");};l.prototype.createSampleStrip=function(a){var c,b,d;c=0;for(b=this._colors.length;c<b;c++)d=document.createElement("div"),d.className="color-sample-strip",d.style.background=
"rgb("+this._colors[c].toString()+")",a.appendChild(d)};l._createColorRange=function(a,c,b){var d,f=[],h=a[0],g=a[1],a=a[2],j=c[1];d=c[2];var i,k,l,o,c=c[0]-h,j=j-g;i=d-a;for(d=0;d<b;d++)k=parseInt(c*d/b,10)+h,l=parseInt(j*d/b,10)+g,o=parseInt(i*d/b,10)+a,f.push([k,l,o]);return f};b.ColorPalette=l;z.prototype.addColor=function(a){b.Interface.checkRequiredParams(a,{name:"string",startColor:"array",endColor:"array"})&&(this[a.name]={startColor:a.startColor,endColor:a.endColor});return this};z.prototype.name=
"ColorTable";z.prototype.getColor=function(a,c,e){var d,f;if("string"===b.Interface.getDataType(a))if(this[a]){a=this[a];c&&(d=a.startColor);e&&(f=a.endColor);if(d&&f||!d&&!f)return{startColor:a.startColor,endColor:a.endColor};if(d)return d;if(f)return f}else throw Error("ColorTable: "+a+" does not exist. Add colors to the ColorTable via addColor().");else throw Error("ColorTable: You must pass a name (string) for the color entry in the table.");};b.ColorTable=z;E.prototype.name="Caption";E.prototype.destroy=
function(){var a=this.el.id;this.el.parentNode.removeChild(this.el);if(!document.getElementById(a))return!0};b.Caption=E;F.prototype.name="InputMenu";F.prototype.destroy=function(){var a=this.el.id;this.el.parentNode.removeChild(this.el);if(!document.getElementById(a))return!0};b.InputMenu=F;b.Burner.Utils.extend(k,b.Burner.Element);k.prototype.name="Mover";k.prototype.mouseover=function(){this.isMouseOut=!1;clearInterval(this.mouseOutInterval)};k.prototype.mousedown=function(a){var c,b=a.target||
a.srcElement;a.changedTouches&&(c=a.changedTouches[0]);a.pageX&&a.pageY?(this.offsetX=a.pageX-b.offsetLeft,this.offsetY=a.pageY-b.offsetTop):a.clientX&&a.clientY?(this.offsetX=a.clientX-b.offsetLeft,this.offsetY=a.clientY-b.offsetTop):c&&(this.offsetX=c.pageX-b.offsetLeft,this.offsetY=c.pageY-b.offsetTop);this.isPressed=!0;this.isMouseOut=!1};k.prototype.mousemove=function(a){var c,e,d;this.isPressed&&(this.isMouseOut=!1,a.changedTouches&&(d=a.changedTouches[0]),a.pageX&&a.pageY?(c=a.pageX-this.world.el.offsetLeft,
e=a.pageY-this.world.el.offsetTop):a.clientX&&a.clientY?(c=a.clientX-this.world.el.offsetLeft,e=a.clientY-this.world.el.offsetTop):d&&(c=d.pageX-this.world.el.offsetLeft,e=d.pageY-this.world.el.offsetTop),b.Utils.mouseIsInsideWorld(this.world)?this.location=new b.Vector(c,e):this.isPressed=!1)};k.prototype.mouseup=function(){this.isPressed=!1};k.prototype.mouseout=function(a,c){var e=b.Burner.System.mouse,d,f;c.isPressed&&(c.isMouseOut=!0,c.mouseOutInterval=setInterval(function(){c.isPressed&&c.isMouseOut&&
(d=e.location.x-c.world.el.offsetLeft,f=e.location.y-c.world.el.offsetTop,c.location=new b.Vector(d,f))},16))};k.prototype.step=function(){var a,c,e;this.beforeStep&&this.beforeStep.apply(this);if(!this.isStatic&&!this.isPressed&&(this.world.c&&(a=b.Utils.clone(this.velocity),a.mult(-1),a.normalize(),a.mult(this.world.c),this.applyForce(a)),this.applyForce(this.world.gravity),this.applyForces&&this.applyForces(),this.velocity.add(this.acceleration),this.maxSpeed&&this.velocity.limit(this.maxSpeed),
this.minSpeed&&this.velocity.limit(null,this.minSpeed),this.location.add(this.velocity),this.pointToDirection&&0.1<this.velocity.mag()))this.angle=b.Utils.radiansToDegrees(Math.atan2(this.velocity.y,this.velocity.x));this.controlCamera&&this._checkCameraEdges();this.checkEdges&&this._checkWorldEdges();this.parent&&(this.offsetDistance?(c=this.offsetDistance,e=b.Utils.degreesToRadians(this.parent.angle+this.offsetAngle),a=c*Math.cos(e),c*=Math.sin(e),this.location.x=this.parent.location.x,this.location.y=
this.parent.location.y,this.location.add(new b.Vector(a,c))):this.location=this.parent.location);this.acceleration.mult(0);this.life<this.lifespan?this.life+=1:-1!==this.lifespan&&b.Burner.System.destroyElement(this);this.afterStep&&this.afterStep.apply(this);this.clock++;return this.clock};k.prototype.applyForce=function(a){return a?(this._forceVector.x=a.x,this._forceVector.y=a.y,this._forceVector.div(this.mass),this.acceleration.add(this._forceVector),this.acceleration):null};k.prototype._seek=
function(a){var c=this.world,a=b.Vector.VectorSub(a.location,this.location),e=a.mag();a.normalize();e<c.bounds[1]/2?(c=b.Utils.map(e,0,c.bounds[1]/2,0,this.maxSpeed),a.mult(c)):a.mult(this.maxSpeed);a.sub(this.velocity);a.limit(this.maxSteeringForce);return a};k.prototype._checkCameraEdges=function(){this.checkCameraEdgesVector.x=this.velocity.x;this.checkCameraEdgesVector.y=this.velocity.y;this.world.location.add(this.checkCameraEdgesVector.mult(-1))};k.prototype._checkWorldEdges=function(){var a=
this.location.x,b=this.location.y,e=this.velocity,d=!1;this.wrapEdges?this.location.x>this.world.bounds[1]?(this.location.x=0,d=!0,this.controlCamera&&(this.cameraDiffVector.x=a-this.location.x,this.cameraDiffVector.y=0)):0>this.location.x&&(this.location.x=this.world.bounds[1],d=!0,this.controlCamera&&(this.cameraDiffVector.x=a-this.location.x,this.cameraDiffVector.y=0)):this.location.x+this.width/2>this.world.bounds[1]?(this.location.x=this.world.bounds[1]-this.width/2,e.x*=-1*this.bounciness,d=
!0,this.controlCamera&&(this.cameraDiffVector.x=a-this.location.x,this.cameraDiffVector.y=0)):this.location.x<this.width/2&&(this.location.x=this.width/2,e.x*=-1*this.bounciness,d=!0,this.controlCamera&&(this.cameraDiffVector.x=a-this.location.x,this.cameraDiffVector.y=0));this.wrapEdges?this.location.y>this.world.bounds[2]?(this.location.y=0,d=!0,this.controlCamera&&(this.cameraDiffVector.x=0,this.cameraDiffVector.y=b-this.location.y)):0>this.location.y&&(this.location.y=this.world.bounds[2],d=!0,
this.controlCamera&&(this.cameraDiffVector.x=0,this.cameraDiffVector.y=b-this.location.y)):this.location.y+this.height/2>this.world.bounds[2]?(this.location.y=this.world.bounds[2]-this.height/2,this.velocity.y*=-1*this.bounciness,d=!0,this.controlCamera&&(this.cameraDiffVector.x=0,this.cameraDiffVector.y=b-this.location.y)):this.location.y<this.height/2&&(this.location.y=this.height/2,this.velocity.y*=-1*this.bounciness,d=!0,this.controlCamera&&(this.cameraDiffVector.x=0,this.cameraDiffVector.y=b-
this.location.y));d&&this.controlCamera&&this.world.location.add(this.cameraDiffVector);return d};k.prototype._checkAvoidEdges=function(){var a,c;this.location.x<this.avoidEdgesStrength?a=this.maxSpeed:this.location.x>this.world.bounds[1]-this.avoidEdgesStrength&&(a=-this.maxSpeed);a&&(c=new b.Vector(a,this.velocity.y),c.sub(this.velocity),c.limit(this.maxSteeringForce),this.applyForce(c));this.location.y<this.avoidEdgesStrength?a=this.maxSpeed:this.location.y>this.world.bounds[2]-this.avoidEdgesStrength&&
(a=-this.maxSpeed);a&&(c=new b.Vector(this.velocity.x,a),c.sub(this.velocity),c.limit(this.maxSteeringForce),this.applyForce(c))};k.prototype.drag=function(a){var c=this.velocity.mag(),a=-1*a.c*c*c,c=b.Utils.clone(this.velocity);c.normalize();c.mult(a);return c};k.prototype.attract=function(a){var c=b.Vector.VectorSub(a.location,this.location),e;e=c.mag();e=b.Utils.constrain(e,this.width*this.height/8,a.width*a.height);c.normalize();c.mult(a.G*a.mass*this.mass/(e*e));return c};k.prototype.isInside=
function(a){return a&&this.location.x+this.width/2>a.location.x-a.width/2&&this.location.x-this.width/2<a.location.x+a.width/2&&this.location.y+this.height/2>a.location.y-a.height/2&&this.location.y-this.height/2<a.location.y+a.height/2?!0:!1};k.prototype.draw=function(){var a,b=this.el;b&&(a=k._getCSSText({x:this.location.x-this.width/2,y:this.location.y-this.height/2,width:this.width,height:this.height,opacity:this.opacity,visibility:this.visibility,a:this.angle,s:this.scale,color:this.color,z:this.zIndex||
1,borderWidth:this.borderWidth,borderStyle:this.borderStyle,borderColor:this.borderColor,borderRadius:this.borderRadius,borderTopWidth:this.borderTopWidth,borderTopStyle:this.borderTopStyle,borderTopColor:this.borderTopColor,borderRightWidth:this.borderRightWidth,borderRightStyle:this.borderRightStyle,borderRightColor:this.borderRightColor,borderBottomWidth:this.borderBottomWidth,borderBottomStyle:this.borderBottomStyle,borderBottomColor:this.borderBottomColor,borderLeftWidth:this.borderLeftWidth,
borderLeftStyle:this.borderLeftStyle,borderLeftColor:this.borderLeftColor,borderTopLeftRadius:this.borderTopLeftRadius,borderTopRightRadius:this.borderTopRightRadius,borderBottomRightRadius:this.borderBottomRightRadius,borderBottomLeftRadius:this.borderBottomLeftRadius}),b.style.cssText=a);return a};k._getCSSText=function(a){var c,e,d,f,h,g;e=b.Burner.System;var j=b.Burner.Utils;e=e.supportedFeatures.csstransforms3d?["-webkit-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+
a.s+") scaleY("+a.s+")","-moz-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translate3d("+a.x+"px, "+a.y+"px, 0) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):e.supportedFeatures.csstransforms?["-webkit-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")",
"-moz-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-o-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")","-ms-transform: translateX("+a.x+"px) translateY("+a.y+"px) rotate("+a.a+"deg) scaleX("+a.s+") scaleY("+a.s+")"].join(";"):["position: absolute","left: "+a.x+"px","top: "+a.y+"px"].join(";");"array"===j.getDataType(a.color)&&(c="rgb("+a.color[0]+", "+a.color[1]+", "+a.color[2]+
")");a.borderWidth?f="number"===j.getDataType(a.borderWidth)?a.borderWidth+"px":a.borderWidth:a.borderTopWidth&&(a.borderRightWidth&&a.borderBottomWidth&&a.borderLeftWidth)&&(f=a.borderTopWidth+"px "+a.borderRightWidth+"px "+a.borderBottomWidth+"px "+a.borderLeftWidth+"px");if(a.borderStyle&&"none"!==a.borderStyle)h=a.borderStyle;else if(a.borderTopStyle||a.borderRightStyle||a.borderBottomStyle||a.borderLeftStyle)h=a.borderTopStyle+" "+a.borderRightStyle+" "+a.borderBottomStyle+" "+a.borderLeftStyle;
if(a.borderColor&&"transparent"!==a.borderColor)g="array"===j.getDataType(a.borderColor)?"rgb("+a.borderColor[0]+", "+a.borderColor[1]+", "+a.borderColor[2]+")":a.borderColor;else if(a.borderTopColor&&a.borderRightColor&&a.borderBottomColor&&a.borderLeftColor){g="array"===j.getDataType(a.borderTopColor)?"rgb("+a.borderTopColor[0]+", "+a.borderTopColor[1]+", "+a.borderTopColor[2]+") ":a.borderTopColor+" ";var i="array"===j.getDataType(a.borderRightColor)?"rgb("+a.borderRightColor[0]+", "+a.borderRightColor[1]+
", "+a.borderRightColor[2]+") ":a.borderRightColor+" ",k="array"===j.getDataType(a.borderBottomColor)?"rgb("+a.borderBottomColor[0]+", "+a.borderBottomColor[1]+", "+a.borderBottomColor[2]+") ":a.borderBottomColor+" ",l="array"===j.getDataType(a.borderLeftColor)?"rgb("+a.borderLeftColor[0]+", "+a.borderLeftColor[1]+", "+a.borderLeftColor[2]+")":a.borderLeftColor;g=g+i+k+l}null!==a.borderRadius?d="number"===j.getDataType(a.borderRadius)?a.borderRadius+"px":a.borderRadius:a.borderTopLeftRadius&&(a.borderTopRightRadius&&
a.borderBottomRightRadius&&a.borderBottomLeftRadius)&&(d="number"===j.getDataType(a.borderTopLeftRadius)?a.borderTopLeftRadius+"px ":a.borderTopLeftRadius+" ",i="number"===j.getDataType(a.borderTopRightRadius)?a.borderTopRightRadius+"px ":a.borderTopRightRadius+" ",k="number"===j.getDataType(a.borderBottomRightRadius)?a.borderBottomRightRadius+"px ":a.borderBottomRightRadius+" ",j="number"===j.getDataType(a.borderBottomLeftRadius)?a.borderBottomLeftRadius+"px ":a.borderBottomLeftRadius,d=d+i+k+j);
return[e,"width: "+a.width+"px","height: "+a.height+"px","opacity: "+a.opacity,"visibility: "+a.visibility,"background-color: "+c,"z-index: "+a.z,"border-radius: "+d,"border-width: "+f,"border-style: "+h,"border-color: "+g].join(";")};b.Mover=k;b.Utils.extend(m,b.Mover);m.prototype.name="Agent";m.prototype.applyForces=function(){var a,c,e,d,f,h,g;d=b.Burner.System._Caches.Liquid;g=b.Burner.System._Caches.Attractor;f=b.Burner.System._Caches.Repeller;if(d&&0<d.list.length){a=0;for(c=d.list.length;a<
c;a+=1)this.id!==d.list[a].id&&b.Utils.isInside(this,d.list[a])&&this.applyForce(this.drag(d.list[a]))}if(g&&0<g.list.length){a=0;for(c=g.list.length;a<c;a+=1)this.id!==g.list[a].id&&this.applyForce(this.attract(g.list[a]))}if(f&&0<f.list.length){a=0;for(c=f.list.length;a<c;a+=1)this.id!==f.list[a].id&&this.applyForce(this.attract(f.list[a]))}if(0<this.sensors.length){a=0;for(c=this.sensors.length;a<c;a+=1)if(d=this.sensors[a],f=d.offsetDistance,h=b.Utils.degreesToRadians(this.angle+d.offsetAngle),
g=f*Math.cos(h),f*=Math.sin(h),d.location.x=this.location.x,d.location.y=this.location.y,d.location.add(new b.Vector(g,f)),0<a&&(d.visibility="hidden"),d.activated)this.applyForce(d.getActivationForce(this)),e=!0}!e&&this.motorSpeed&&(a=b.Utils.clone(this.velocity),a.normalize(),this.velocity.mag()>this.motorSpeed?a.mult(-this.motorSpeed):a.mult(this.motorSpeed),this.applyForce(a));this.followMouse&&(a={location:new b.Vector(b.Burner.System.mouse.location.x,b.Burner.System.mouse.location.y)},this.applyForce(this._seek(a)));
this.seekTarget&&this.applyForce(this._seek(this.seekTarget));this.flowField&&(c=this.flowField.resolution,a=Math.floor(this.location.x/c),c=Math.floor(this.location.y/c),this.flowField.field[a]&&((a=this.flowField.field[a][c])?(this.followTargetVector.x=a.x,this.followTargetVector.y=a.y):(this.followTargetVector.x=this.location.x,this.followTargetVector.y=this.location.y),a={location:this.followTargetVector},this.applyForce(this.follow(a))));this.flocking&&this.flock(b.Burner.System.getAllElementsByName("Agent"));
return this.acceleration};m.prototype.follow=function(a){this.followDesiredVelocity.x=a.location.x;this.followDesiredVelocity.y=a.location.y;this.followDesiredVelocity.mult(this.maxSpeed);this.followDesiredVelocity.sub(this.velocity);this.followDesiredVelocity.limit(this.maxSteeringForce);return this.followDesiredVelocity};m.prototype.flock=function(a){this.applyForce(this.separate(a).mult(this.separateStrength));this.applyForce(this.align(a).mult(this.alignStrength));this.applyForce(this.cohesion(a).mult(this.cohesionStrength));
return this.acceleration};m.prototype.separate=function(a){var c,e,d,f,h,g=0;this.separateSumForceVector.x=0;this.separateSumForceVector.y=0;h=this.separateSumForceVector;c=0;for(e=a.length;c<e;c+=1)d=a[c],this.className===d.className&&this.id!==d.id&&(f=this.location.distance(d.location),0<f&&f<this.desiredSeparation&&(d=b.Vector.VectorSub(this.location,d.location),d.normalize(),d.div(f),h.add(d),g+=1));return 0<g?(h.div(g),h.normalize(),h.mult(this.maxSpeed),h.sub(this.velocity),h.limit(this.maxSteeringForce),
h):new b.Vector};m.prototype.align=function(a){var c,e,d,f,h=2*this.width,g,j=0;this.alignSumForceVector.x=0;this.alignSumForceVector.y=0;g=this.alignSumForceVector;c=0;for(e=a.length;c<e;c+=1)d=a[c],f=this.location.distance(d.location),0<f&&f<h&&(this.className===d.className&&this.id!==d.id)&&(g.add(d.velocity),j+=1);return 0<j?(g.div(j),g.normalize(),g.mult(this.maxSpeed),g.sub(this.velocity),g.limit(this.maxSteeringForce),g):new b.Vector};m.prototype.cohesion=function(a){var c,e,d,f,h,g=0;this.cohesionSumForceVector.x=
0;this.cohesionSumForceVector.y=0;h=this.cohesionSumForceVector;c=0;for(e=a.length;c<e;c+=1)d=a[c],f=this.location.distance(d.location),0<f&&10>f&&(this.className===d.className&&this.id!==d.id)&&(h.add(d.location),g+=1);return 0<g?(h.div(g),h.sub(this.location),h.normalize(),h.mult(this.maxSpeed),h.sub(this.velocity),h.limit(this.maxSteeringForce),h):new b.Vector};m.prototype.getLocation=function(a){if(a){if("x"===a)return this.location.x;if("y"===a)return this.location.y}else return new b.Vector(this.location.x,
this.location.y)};m.prototype.getVelocity=function(a){if(a){if("x"===a)return this.velocity.x;if("y"===a)return this.velocity.y}else return new b.Vector(this.location.x,this.location.y)};b.Agent=m;b.Utils.extend(A,b.Mover);A.prototype.name="Walker";A.prototype.applyForces=function(){this.perlin?(this.perlinTime+=this.perlinSpeed,this.remainsOnScreen?(this.acceleration=new b.Vector,this.velocity=new b.Vector,this.location.x=b.Utils.map(b.SimplexNoise.noise(this.perlinTime+this.offsetX,0,0.1),-1,1,
0,this.world.bounds[1]),this.location.y=b.Utils.map(b.SimplexNoise.noise(0,this.perlinTime+this.offsetY,0.1),-1,1,0,this.world.bounds[2])):(this.acceleration.x=b.Utils.map(b.SimplexNoise.noise(this.perlinTime+this.offsetX,0,0.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh),this.acceleration.y=b.Utils.map(b.SimplexNoise.noise(0,this.perlinTime+this.offsetY,0.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh))):this.random&&(this.seekTarget={location:b.Vector.VectorAdd(this.location,new b.Vector(b.Utils.getRandomNumber(-this.randomRadius,
this.randomRadius),b.Utils.getRandomNumber(-this.randomRadius,this.randomRadius)))},this.applyForce(this._seek(this.seekTarget)));this.avoidEdges&&this._checkAvoidEdges()};b.Walker=A;b.Utils.extend(s,b.Agent);s.prototype.name="Sensor";s.prototype.step=function(){var a=!1,c,e,d=b.Burner.System._Caches.Heat||{list:[]},f=b.Burner.System._Caches.Cold||{list:[]},h=b.Burner.System._Caches.Predators||{list:[]},g=b.Burner.System._Caches.Light||{list:[]},j=b.Burner.System._Caches.Oxygen||{list:[]},i=b.Burner.System._Caches.Food||
{list:[]};if("heat"===this.type&&d.list&&0<d.list.length){c=0;for(e=d.list.length;c<e;c++)this.isInside(this,d.list[c],this.sensitivity)&&(this.target=d.list[c],a=this.activated=!0)}else if("cold"===this.type&&f.list&&0<f.list.length){c=0;for(e=f.list.length;c<e;c++)this.isInside(this,f.list[c],this.sensitivity)&&(this.target=f.list[c],a=this.activated=!0)}else if("predator"===this.type&&h.list&&0<h.list.length){c=0;for(e=h.list.length;c<e;c+=1)this.isInside(this,h.list[c],this.sensitivity)&&(this.target=
h.list[c],a=this.activated=!0)}else if("light"===this.type&&g.list&&0<g.list.length){c=0;for(e=g.list.length;c<e;c++)g.lookup[g.list[c].id]&&this.isInside(this,g.list[c],this.sensitivity)&&(this.target=g.list[c],a=this.activated=!0)}else if("oxygen"===this.type&&j.list&&0<j.list.length){c=0;for(e=j.list.length;c<e;c+=1)j.lookup[j.list[c].id]&&this.isInside(this,j.list[c],this.sensitivity)&&(this.target=j.list[c],a=this.activated=!0)}else if("food"===this.type&&i.list&&0<i.list.length){c=0;for(e=i.list.length;c<
e;c+=1)i.lookup[i.list[c].id]&&this.isInside(this,i.list[c],this.sensitivity)&&(this.target=i.list[c],a=this.activated=!0)}a?this.color=this.activatedColor:(this.target=null,this.activated=!1,this.color="transparent");this.afterStep&&this.afterStep.apply(this)};s.prototype.getActivationForce=function(a){var c;switch(this.behavior){case "AGGRESSIVE":return this._seek(this.target);case "COWARD":return this._seek(this.target).mult(-1);case "LIKES":var e=b.Vector.VectorSub(this.target.location,this.location);
c=e.mag();e.normalize();c/=a.maxSpeed;e.mult(c);c=b.Vector.VectorSub(e,a.velocity);c.limit(a.maxSteeringForce);return c;case "LOVES":e=b.Vector.VectorSub(this.target.location,this.location);c=e.mag();e.normalize();if(c>this.width)return c/=a.maxSpeed,e.mult(c),c=b.Vector.VectorSub(e,a.velocity),c.limit(a.maxSteeringForce),c;a.velocity=new b.Vector;a.acceleration=new b.Vector;return new b.Vector;case "EXPLORER":return e=b.Vector.VectorSub(this.target.location,this.location),c=e.mag(),e.normalize(),
c/=a.maxSpeed,e.mult(-c),c=b.Vector.VectorSub(e,a.velocity),c.limit(0.01*a.maxSteeringForce),c;case "ACCELERATE":return c=a.velocity.clone(),c.normalize(),c.mult(a.minSpeed);case "DECELERATE":return c=a.velocity.clone(),c.normalize(),c.mult(-a.minSpeed);default:return new b.Vector}};s.prototype.isInside=function(a,b,e){return a.location.x+a.width/2>b.location.x-b.width/2-e*b.width&&a.location.x-a.width/2<b.location.x+b.width/2+e*b.width&&a.location.y+a.height/2>b.location.y-b.height/2-e*b.height&&
a.location.y-a.height/2<b.location.y+b.height/2+e*b.height?!0:!1};b.Sensor=s;b.Utils.extend(G,b.Agent);G.prototype.name="Liquid";b.Liquid=G;b.Utils.extend(H,b.Agent);H.prototype.name="Heat";b.Heat=H;b.Utils.extend(I,b.Agent);I.prototype.name="Cold";b.Cold=I;b.Utils.extend(J,b.Agent);J.prototype.name="Oxygen";b.Oxygen=J;b.Utils.extend(K,b.Agent);K.prototype.name="Light";b.Light=K;b.Utils.extend(B,b.Agent);B.prototype.name="Connector";B.prototype.step=function(){var a=this.parentA.location,c=this.parentB.location;
this.width=Math.floor(b.Vector.VectorSub(this.parentA.location,this.parentB.location).mag());this.location=b.Vector.VectorAdd(this.parentA.location,this.parentB.location).div(2);this.angle=b.Utils.radiansToDegrees(Math.atan2(c.y-a.y,c.x-a.x))};b.Connector=B;b.Utils.extend(L,b.Agent);L.prototype.name="Point";b.Point=L;b.Utils.extend(M,b.Agent);M.prototype.name="Food";b.Food=M;b.Utils.extend(C,b.Agent);C.prototype.name="Particle";C.prototype.step=function(){var a;this.world.c&&(a=b.Utils.clone(this.velocity),
a.mult(-1),a.normalize(),a.mult(this.world.c),this.applyForce(a));this.applyForce(this.world.gravity);this.applyForces&&this.applyForces();this.checkEdges&&this._checkWorldEdges();this.velocity.add(this.acceleration);this.maxSpeed&&this.velocity.limit(this.maxSpeed);this.minSpeed&&this.velocity.limit(null,this.minSpeed);this.location.add(this.velocity);this.fade&&(this.opacity=b.Utils.map(this.life,0,this.lifespan,1,0));this.shrink&&(this.width=b.Utils.map(this.life,0,this.lifespan,this.initWidth,
0),this.height=b.Utils.map(this.life,0,this.lifespan,this.initHeight,0));this.acceleration.mult(0);this.life<this.lifespan?this.life+=1:-1!==this.lifespan&&b.Burner.System.destroyElement(this)};b.Particle=C;b.Utils.extend(t,b.Agent);t.getParticleLocation=function(a){return new b.Vector(a.x,a.y)};t.prototype.name="ParticleSystem";b.ParticleSystem=t;b.Utils.extend(D,b.Agent);D.prototype.name="Oscillator";D.prototype.step=function(){var a=this.world,c;this.beforeStep&&this.beforeStep.apply(this);if(!this.isStatic&&
!this.isPressed&&(this.isPerlin?(this.perlinTime+=this.perlinSpeed,this.aVelocity.x=b.Utils.map(b.SimplexNoise.noise(this.perlinTime+this.perlinOffsetX,0,0.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh),this.aVelocity.y=b.Utils.map(b.SimplexNoise.noise(0,this.perlinTime+this.perlinOffsetY,0.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh)):this.aVelocity.add(this.acceleration),this.location.x=this.initialLocation.x+Math.sin(this.aVelocity.x)*this.amplitude.x,this.location.y=this.initialLocation.y+
Math.sin(this.aVelocity.y)*this.amplitude.y,this.pointToDirection&&(c=b.Vector.VectorSub(this.location,this.lastLocation),this.angle=b.Utils.radiansToDegrees(Math.atan2(c.y,c.x))),this.controlCamera&&this._checkCameraEdges(),(this.checkEdges||this.wrapEdges)&&this._checkWorldEdges(a),0<this.lifespan&&(this.lifespan-=1),this.afterStep&&this.afterStep.apply(this),this.pointToDirection))this.lastLocation.x=this.location.x,this.lastLocation.y=this.location.y};b.Oscillator=D;b.Utils.extend(N,b.Agent);
N.prototype.name="Attractor";b.Attractor=N;b.Utils.extend(O,b.Agent);O.prototype.name="Repeller";b.Repeller=O;P.prototype.name="FlowField";P.prototype.build=function(){var a,c,e,d,f,h,g,j,i={},k=this.world,l=Math.ceil(k.bounds[1]/parseFloat(this.resolution)),o=Math.ceil(k.bounds[2]/parseFloat(this.resolution)),m=this.perlinTime,n;for(a=0;a<l;a+=1){n=this.perlinTime;i[a]={};c=0;for(e=o;c<e;c+=1)d=a*this.resolution+this.resolution/2,f=c*this.resolution+this.resolution/2,h=b.Utils.map(b.SimplexNoise.noise(m,
n,0.1),0,1,0,2*Math.PI),g=Math.cos(h),j=Math.sin(h),h=new b.Vector(g,j),i[a][c]=h,g=b.Utils.radiansToDegrees(Math.atan2(j,g)),this.createMarkers&&(d=new b.FlowFieldMarker({location:new b.Vector(d,f),scale:1,opacity:b.Utils.map(g,-360,360,0.1,1),width:this.resolution,height:this.resolution/2,field:h,angle:g,colorMode:"rgb",color:[200,100,50]}),k.el.appendChild(d)),n+=parseFloat(this.perlinSpeed);m+=parseFloat(this.perlinSpeed)}this.field=i};b.FlowField=P;R.prototype.name="FlowFieldMarker";b.FlowFieldMarker=
R;b.Utils.addEvent(document,"keyup",function(a){a.keyCode===u.keyMap.pause&&b.Burner.PubSub.publish("pause");a.keyCode===u.keyMap.resetSystem&&b.Burner.PubSub.publish("resetSystem");a.keyCode===u.keyMap.destroySystem&&b.Burner.PubSub.publish("destroySystem");a.keyCode===u.keyMap.stats&&b.Burner.PubSub.publish("stats")})})(exports);
